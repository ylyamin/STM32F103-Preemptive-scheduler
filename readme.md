# STM32F103 Preemptive scheduler

## Overview
This a project with Simple Task Scheduler based an STM32F103 board with ARM® Cortex®-M3 MCU. \
With an intention to help to learn the Operating System basises. \
Time-triggered Preemptive round-robin Scheduler with stack switching between already pre-built tasks.

Purely bare-metal embedded-c and register manipulations without using any STM32Cubemx®-generated code, frameworks or HAL libraries. \
It is pain way to learn low level software development. \
For user interaction used UART with a simple Command Line Interface 

Inspired by Kiran Nayak, FastBit Academy cource - Embedded Systems Programming on ARM Cortex-M3/M4 Processor \
https://www.udemy.com/course/embedded-system-programming-on-arm-cortex-m3m4/

### Tools:
* OS: Windows 10 x64 
* Code editor and Debbuger: [VS code](https://code.visualstudio.com/) with extensions: [Code Runner](https://marketplace.visualstudio.com/items?itemName=formulahendry.code-runner), [Cortex-Debug](https://marketplace.visualstudio.com/items?itemName=marus25.cortex-debug)
* Compiler: GNU ARM GCC  - https://github.com/xpack-dev-tools/arm-none-eabi-gcc-xpack/releases/tag/v11.2.1-1.2/
* Build automation: GNU Make - https://gnuwin32.sourceforge.net/packages/make.htm
* Interfaces with JTAG debugger: OpenOCD - https://github.com/openocd-org/openocd/releases/tag/v0.11.0

### Hardware:
* Blue Pill [STM32F103C8T6](https://stm32-base.org/boards/STM32F103C8T6-Blue-Pill.html) board (Arm® 32-bit Cortex®-M3 CPU core 72MHz, 64Kb Flash, 20Kb SRAM)
* ST-Link V2 Mini - debugger and programmer.
* FTDI FT232RL - USB to UART interface 

### External dependency
* Command Line Interface from project - Embedded CLI https://github.com/funbiscuit/embedded-cli/tree/v0.1.2
* Newlib-nano from GNU Arm Embedded Toolchain
* STM32F103C8TX_FLASH.ld, syscalls.c, sysmem.c for support libc so far still copy from generated by STM32CubeIDE

### Instalation
* For build use:
```
make all;
```
* For flash and debug use: VS code/Code Runner configured by .vscode/launch.json

### Documentation
* [Cortex™-M3 Devices Generic User Guide](https://documentation-service.arm.com/static/5ea823e69931941038df1af5?token=)
* [STM32F103x8 datasheet](https://www.st.com/resource/en/datasheet/stm32f103c8.pdf)
* [stm32f10x Reference manual](https://www.st.com/resource/en/reference_manual/cd00171190-stm32f101xx-stm32f102xx-stm32f103xx-stm32f105xx-and-stm32f107xx-advanced-armbased-32bit-mcus-stmicroelectronics.pdf)
* [stm32f10x Programming manual](https://www.st.com/resource/en/programming_manual/pm0056-stm32f10xxx20xxx21xxxl1xxxx-cortexm3-programming-manual-stmicroelectronics.pdf)


### TODO:
- [ ] Re-structure project according C guidelines and best practice
- [ ] Embeedded CLI depends of malloc() from libc figure out how to replace this
- [ ] printf() depends of syscalls.c figure out how how to replace this
- [ ] Led seems configured not fully properly
- [ ] Figure out how to use BOOT jumper
- [ ] Embedded cli library - do it as git submodule